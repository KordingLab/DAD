function [What,FVAL,R2,R3] = rotate2KL(Xtrain,Ytest_ext,Winit,numiter)

numouter = 2;

p_train = prob_grid(normal(Xtrain));
x_sz = 2;

for iout = 1:numouter
    options= optimoptions('fminunc','Algorithm','quasi-newton',...
    'GradObj','off','Display','off', 'MaxFunEvals', 1.5e4);

    ftheta= @(theta)evalKLDiv_gridwrot(Winit,theta,Ytest_ext, x_sz, p_train);

    theta_hat = zeros(72,1); 
    FVAL = zeros(72,1);
    for i=1:72
        [theta_hat(i),FVAL(i)] = fminunc(ftheta,i*5, options); 
    end

    [~,id] = min(FVAL);
    Outs.R{i = rotmat(theta_hat(id));

    fKL= @(W)evalKLDiv_gridwrot(W,theta_hat(id), Ytest_ext, x_sz, p_train);

    if nargin>3
        options= optimoptions('fminunc','Algorithm','quasi-newton',...
        'GradObj','off','Display','iter-detailed', 'MaxFunEvals', 1.5e4,...
        'maxIter',numiter);
    else
        options= optimoptions('fminunc','Algorithm','quasi-newton',...
        'GradObj','off','Display','iter-detailed', 'MaxFunEvals', 1.5e4,...
        'maxIter',5);
    end

    [What{i}, FVAL]= fminunc(fKL, Winit, options);

end


end